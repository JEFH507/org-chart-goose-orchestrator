<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>Reference One‑Pager</title>
  <script>
    (function(){
      const saved = localStorage.getItem('theme') || 'dark';
      document.documentElement.setAttribute('data-theme', saved);
    })();
  </script>
  <script src="https://cdn.jsdelivr.net/npm/mermaid@10.9.4/dist/mermaid.min.js"></script>
  <style>
    :root[data-theme="dark"]{ --bg:#0b1220; --panel:#0f172a; --border:#1f2a44; --text:#e2e8f0; --muted:#93a4bc; --link:#60a5fa; }
    :root[data-theme="light"]{ --bg:#ffffff; --panel:#ffffff; --border:#e2e8f0; --text:#0f172a; --muted:#475569; --link:#2563eb; }
    body { font-family: Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Arial, sans-serif; margin: 0; color: var(--text); background: var(--bg); }
    .layout { display: flex; min-height: 100vh; }
    nav { width: 260px; background: var(--panel); border-right: 1px solid var(--border); padding: 16px; position: sticky; top: 0; height: 100vh; }
    nav h2 { margin: 0 0 12px 0; font-size: 14px; color: var(--muted); letter-spacing: 0.06em; text-transform: uppercase; }
    nav a, nav button { display: block; color: var(--link); text-decoration: none; margin: 6px 0; font-size: 14px; background: none; border: none; padding: 0; text-align: left; cursor: pointer; }
    nav a:hover { text-decoration: underline; }
    main { flex: 1; padding: 24px; }
    .card { border: 1px solid var(--border); border-radius: 12px; padding: 16px; margin: 16px 0; background: var(--panel); box-shadow: 0 10px 30px rgba(0,0,0,0.15); }
    h1 { margin: 0.5em 0; font-weight: 700; }
    .meta { color: var(--muted); }
    .pager { display: flex; justify-content: space-between; margin-top: 12px; }
    .pager a { color: var(--muted); text-decoration: none; font-size: 14px; }
    .pager a:hover { text-decoration: underline; }
  </style>
  <script>
    const theme = (document.documentElement.getAttribute('data-theme')==='light') ? 'default' : 'dark';
    mermaid.initialize({ startOnLoad: true, theme });
  </script>
</head>
<body>
  <div class="layout">
    <div id="topnav"></div>
    <div id="sidenav"></div>
    <main>
      <h1>Reference One‑Pager</h1>
      <p class="meta">OSS-first, local-first orchestrator view — HTTP-only MVP, OIDC SSO, Vault+KMS, agent pre/post Privacy Guard</p>
      <div class="card">
        <p style="margin:0 0 8px 0; color: var(--muted)">CE vs SaaS snapshot: CE uses Keycloak/Vault OSS/Postgres/MinIO; SaaS uses managed OIDC/Vault/KMS/SQL/S3. Agent guard is primary; provider middleware optional (CE off by default).</p>
        <div class="mermaid">
        flowchart LR
          subgraph Orchestrator
            DIR["Org Directory & Policy"]
            ROUTER["Task Router & Skills Graph"]
            CTX["Cross-Agent Session Broker"]
            AUD["Audit & Observability"]
            GBL_POL["Global Policies"]
          end

          subgraph Agents["Agent Instances (per role/user/dept)"]
            CS["C-Suite Twin"]
            MKT["Marketing Twin"]
            FIN["Finance Twin"]
            ENG["Engineering Twin"]
            MGR["Manager Twin"]
            IC["IC Twin"]
          end

          subgraph Agent_Internal["Each Agent"]
            UI["UI/CLI/API"]
            CORE["Agent Brain (Goose-based)"]
            PRIV["Privacy Guard (Local LLM + masking)"]
            EXT["MCP Extensions"]
            MEM["Session/Memory"]
            LOC_PROF["Local: Recipes / Memory / Policies / Hints / Ignore"]
            GBL_PROF["Global: Recipes / Memory / Policies / Hints / Ignore"]
          end

          subgraph Models
            LOCALLLM["Local LLM"]
            CLOUDLLM["Cloud LLM"]
          end

          subgraph Data["Data / Integrations"]
            FS["Local FS / Repos"]
            SAAS["SaaS via MCP"]
            DESKTOP["Desktop Software (VS Code, Adobe, etc.)"]
            DB["Databases / Data Lake"]
          end

          DIR --> ROUTER --> CTX --> AUD
          GBL_POL --> ROUTER

          CS <--> DIR
          MKT <--> DIR
          FIN <--> DIR
          ENG <--> DIR
          MGR <--> DIR
          IC <--> DIR

          UI --> CORE --> PRIV --> LOCALLLM
          CORE --> CLOUDLLM
          CORE --> EXT --> SAAS
          EXT --> FS
          EXT --> DB
          EXT --> DESKTOP
          CORE --> MEM
          CORE --> LOC_PROF
          CORE --> GBL_PROF

          CS <--> MKT
          CS <--> FIN
          CS <--> ENG
          ENG <--> MGR
          MGR <--> IC
          CORE <--> CTX
          CORE <--> ROUTER
        </div>
      </div>
      <div class="pager">
        <a href="../index.html">← Home</a>
        <a href="overview.html">Executive overview →</a>
      </div>
    </main>
  </div>
  <script>
    document.getElementById('themeToggle').addEventListener('click', function(){
      const cur = document.documentElement.getAttribute('data-theme') || 'dark';
      const next = (cur === 'dark') ? 'light' : 'dark';
      localStorage.setItem('theme', next);
      location.reload();
    });
  </script>
  <script src="../assets/nav.js"></script>
  <script>
    (async function(){
      try { const res = await fetch('_topnav.html'); if(res.ok){ document.getElementById('topnav').innerHTML = await res.text(); }} catch(e){}
    })();
  </script>
</body>
</html>
