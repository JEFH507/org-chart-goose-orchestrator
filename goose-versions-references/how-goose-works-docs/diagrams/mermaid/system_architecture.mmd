graph LR
  subgraph Interface
    UI[Desktop App (Electron)]
    CLI[CLI]
    ACP[ACP Clients]
  end

  subgraph Server
    GO[goose-server<br/>(goosed)]
    OA[OpenAPI]
  end

  subgraph Agent_Engine[Agent Engine (crates/goose)]
    AG[Agent Loop]
    PRV[Providers]
    ROUT[Tool Router]
    SHIM[Tool Shim]
    SESS[Session & Context Mgmt]
    PERM[Permission Modes & Tool Permissions]
    SEC[Security (Prompt Injection)]
    ERR[Error Handling]
    SCH[Scheduler APIs]
    LOG[Logging/Tracing]
    CFG[Config/Env]
  end

  subgraph Extensions[MCP Extensions]
    BEXT[Built-in Extensions (e.g., developer, memory)]
    HEXT[External MCP Servers]
  end

  subgraph Sched[Scheduler]
    TEMP[temporal-service (Go)]
  end

  UI --> OA
  CLI --> OA
  ACP --> GO
  OA --> GO
  GO --> AG

  AG --> PRV
  AG --> ROUT
  AG --> SHIM
  AG --> SESS
  AG --> PERM
  AG --> SEC
  AG --> ERR
  AG --> LOG
  AG --> CFG
  AG --> SCH

  AG --> BEXT
  AG --> HEXT

  SCH --> TEMP
